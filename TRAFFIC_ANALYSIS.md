# üîç –ê–Ω–∞–ª–∏–∑: –ú–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ /movie/[id] –±–µ–∑ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

### ‚úÖ –ß—Ç–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–û—Ç–∫–ª—é—á–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π prefetch** –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:

   - `movie-card.tsx` ‚Üí `prefetch={false}`
   - `hero-section.tsx` ‚Üí `prefetch={false}`
   - `related-movies.tsx` ‚Üí `prefetch={false}`

2. **–î–æ–±–∞–≤–ª–µ–Ω–æ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**:

   - –î–µ—Ç–∞–ª–∏ —Ñ–∏–ª—å–º–∞: 24 —á–∞—Å–∞
   - –ö—Ä–µ–¥–∏—Ç—ã: 7 –¥–Ω–µ–π
   - –í–∏–¥–µ–æ: 7 –¥–Ω–µ–π
   - –ü–æ—Ö–æ–∂–∏–µ —Ñ–∏–ª—å–º—ã: 1 —á–∞—Å

3. **–ù–∞—Å—Ç—Ä–æ–µ–Ω ISR –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ñ–∏–ª—å–º–∞**:

   - `revalidate = 3600` (1 —á–∞—Å)
   - `dynamicParams = true` (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ –∑–∞–ø—Ä–æ—Å—É)

4. **–î–æ–±–∞–≤–ª–µ–Ω middleware –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**:
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–æ—Ç–æ–≤
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ prefetch –∑–∞–ø—Ä–æ—Å–æ–≤

### ü§ñ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –ë–ï–ó –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π:

#### 1. **–ë–æ—Ç—ã –∏ –∫—Ä–∞—É–ª–µ—Ä—ã** (90% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)

```
Googlebot, Bingbot, YandexBot –∏ –¥—Ä—É–≥–∏–µ:
- –ò–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∞–π—Ç–µ
- –°–ª–µ–¥—É—é—Ç –ø–æ –∫–∞–∂–¥–æ–º—É <Link> –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É
- –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç Open Graph –ø—Ä–µ–≤—å—é
- –ü—Ä–æ–≤–µ—Ä—è—é—Ç sitemap.xml

–†–µ—à–µ–Ω–∏–µ: ‚úÖ –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è SEO!
```

#### 2. **Social Media Crawlers** (—á–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞)

```
Facebook, Twitter, LinkedIn, WhatsApp:
- –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –ø—Ä–µ–≤—å—é –ø—Ä–∏ —à–µ—Ä–∏–Ω–≥–µ
- –ü—Ä–æ–≤–µ—Ä—è—é—Ç Open Graph –º–µ—Ç–∞—Ç–µ–≥–∏
- –ö–µ—à–∏—Ä—É—é—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –æ–ø–∏—Å–∞–Ω–∏—è

–í–∏–¥–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º —Å User-Agent:
- facebookexternalhit
- Twitterbot
- LinkedInBot
```

#### 3. **Prefetch –≤ Production** (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ –ø–æ—Å–ª–µ —Ñ–∏–∫—Å–∞)

```
–í development prefetch –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é.
–í production Next.js –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –¥–µ–ª–∞–µ—Ç prefetch.

–†–µ—à–µ–Ω–∏–µ: ‚úÖ –£–∂–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ —á–µ—Ä–µ–∑ prefetch={false}
```

#### 4. **ISR Rebuild** (Vercel/Next.js)

```
Next.js –º–æ–∂–µ—Ç –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è revalidate –≤—Ä–µ–º–µ–Ω–∏
- –ü—Ä–∏ —Ä—É—á–Ω–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–µ—à–∞

–≠—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û –¥–ª—è ISR!
```

#### 5. **Vercel Analytics / Monitoring**

```
Vercel –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å health checks:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- Warmup –ø–æ—Å–ª–µ cold start

–û–±—ã—á–Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö.
```

## üõ°Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã

### 1. –°–æ–∑–¥–∞—Ç—å robots.txt

\`\`\`txt

# /public/robots.txt

User-agent: \*
Allow: /
Disallow: /api/
Disallow: /admin
Disallow: /\_next/
Disallow: /private

# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –∫—Ä–∞—É–ª–∏–Ω–≥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

Crawl-delay: 1

# Sitemap

Sitemap: https://new-movies.online/sitemap.xml
\`\`\`

### 2. –î–æ–±–∞–≤–∏—Ç—å Rate Limiting –≤ middleware

\`\`\`typescript
// src/middleware.ts
const rateLimitMap = new Map<string, number[]>();

export function middleware(request: NextRequest) {
const ip = request.headers.get('x-forwarded-for') || 'unknown';
const now = Date.now();

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É —Å –æ–¥–Ω–æ–≥–æ IP
const requests = rateLimitMap.get(ip) || [];
const recentRequests = requests.filter(time => now - time < 60000);

if (recentRequests.length >= 10) {
console.warn(`[RATE LIMIT] IP ${ip} exceeded limit`);
return new NextResponse('Too Many Requests', { status: 429 });
}

recentRequests.push(now);
rateLimitMap.set(ip, recentRequests);

return NextResponse.next();
}
\`\`\`

### 3. –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –±–æ—Ç–æ–≤

\`\`\`typescript
// –í middleware.ts
const BLOCKED_BOTS = [
'semrush',
'ahrefs',
'mj12bot',
'dotbot',
'rogerbot',
];

export function middleware(request: NextRequest) {
const userAgent = request.headers.get('user-agent')?.toLowerCase() || '';

if (BLOCKED_BOTS.some(bot => userAgent.includes(bot))) {
console.log('[BLOCKED BOT]', userAgent);
return new NextResponse('Forbidden', { status: 403 });
}

return NextResponse.next();
}
\`\`\`

### 4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å generateStaticParams

\`\`\`typescript
// src/app/movie/[id]/page.tsx
export async function generateStaticParams() {
// –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ TOP –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã –ø—Ä–∏ build
const popularMovies = await getCachedPopularMovies();

// –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 20 —Ñ–∏–ª—å–º–æ–≤
return popularMovies.results.slice(0, 20).map(movie => ({
id: movie.id.toString()
}));
}

// –û—Å—Ç–∞–ª—å–Ω—ã–µ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ –∑–∞–ø—Ä–æ—Å—É (ISR)
export const dynamicParams = true;
\`\`\`

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Production

### Vercel Analytics

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Vercel Dashboard:

1. **Functions Tab**:

   ```
   –°–º–æ—Ç—Ä–∏—Ç–µ:
   - Invocations count
   - By path: /movie/[id]
   - By user agent
   ```

2. **Logs Tab**:

   ```
   –§–∏–ª—å—Ç—Ä –ø–æ:
   - path:/movie/
   - status:200
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ User-Agent
   ```

3. **Speed Insights**:
   ```
   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - Real User Metrics (—Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
   - Lab Data (—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã)
   ```

### Middleware Logs

–° —Ç–µ–∫—É—â–∏–º middleware –≤—ã —É–≤–∏–¥–∏—Ç–µ:

\`\`\`
[MOVIE PAGE REQUEST] {
path: '/movie/123',
referer: 'direct', // <- –ï—Å–ª–∏ 'direct' - —ç—Ç–æ –ù–ï –ø–µ—Ä–µ—Ö–æ–¥ —Å –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞
ip: '66.249.64.1', // <- Google IP
isBot: true, // <- –≠—Ç–æ –±–æ—Ç!
isPrefetch: false,
userAgent: 'Mozilla/5.0 (compatible; Googlebot/2.1; +http...'
}
\`\`\`

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ (–≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):

1. ‚úÖ Prefetch –æ—Ç–∫–ª—é—á–µ–Ω ‚Üí –∑–∞–ø—Ä–æ—Å—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ
2. ‚úÖ ISR –Ω–∞—Å—Ç—Ä–æ–µ–Ω ‚Üí –∫–µ—à –Ω–∞ 1 —á–∞—Å
3. ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ TMDB API ‚Üí –¥–æ 7 –¥–Ω–µ–π
4. ‚úÖ Middleware –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ‚Üí –≤–∏–¥–Ω—ã –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
5. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Next.js ‚Üí linkNoTouchStart, optimizeCss

### –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –≤—Å–µ –µ—â–µ –µ—Å—Ç—å - —ç—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û, –µ—Å–ª–∏:

- ‚úÖ User-Agent —Å–æ–¥–µ—Ä–∂–∏—Ç "bot", "crawler", "spider"
- ‚úÖ Referer: direct (–Ω–µ —Å –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞)
- ‚úÖ IP –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç Google/Bing/Yandex
- ‚úÖ –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è (ISR rebuild)
- ‚úÖ –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –¥–µ–ª–∞—é—Ç –ø—Ä–µ–≤—å—é

### –¢—Ä–µ–≤–æ–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (—Ç—Ä–µ–±—É—é—Ç –¥–µ–π—Å—Ç–≤–∏–π):

- ‚ö†Ô∏è –ó–∞–ø—Ä–æ—Å—ã —Å –æ–¥–Ω–æ–≥–æ IP > 100/–º–∏–Ω—É—Ç—É
- ‚ö†Ô∏è Referer —Å –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞ –±–µ–∑ –∫–ª–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚ö†Ô∏è isPrefetch: true –≤ –ª–æ–≥–∞—Ö
- ‚ö†Ô∏è –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ movieId –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
- ‚ö†Ô∏è –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π User-Agent (—Å–∫—Ä–∏–ø—Ç—ã, –±–æ—Ç—ã)

## üéØ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Vercel

1. –ó–∞–π–¥–∏—Ç–µ –≤ **Vercel Dashboard ‚Üí Your Project ‚Üí Analytics**
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ **Top Paths** - –∫–∞–∫–∏–µ URL –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **User Agents** - –∫—Ç–æ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ **Time Series** - –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –ø–∏–∫–∏

**–ï—Å–ª–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –±–æ—Ç–æ–≤** - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏!

**–ï—Å–ª–∏ –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- Browser DevTools ‚Üí Network ‚Üí Prefetch requests
- Middleware logs ‚Üí isPrefetch flag
- –í–æ–∑–º–æ–∂–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ

## üìù –î–µ–π—Å—Ç–≤–∏—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

1. **–î–µ–ø–ª–æ–π –Ω–∞ Vercel** —Å —Ç–µ–∫—É—â–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
2. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 24 —á–∞—Å–∞** –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Vercel Analytics** - —Å–º–æ—Ç—Ä–∏—Ç–µ User-Agent
4. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ middleware logs** –≤ Vercel Logs

## üí° –ò—Ç–æ–≥

–í—Å–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ä—ã –ø—Ä–∏–Ω—è—Ç—ã:

- ‚úÖ Prefetch –æ—Ç–∫–ª—é—á–µ–Ω
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ
- ‚úÖ ISR –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ–±–∞–≤–ª–µ–Ω

**–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –æ—Å—Ç–∞–ª–∏—Å—å** - —ç—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ **SEO –±–æ—Ç—ã**, —á—Ç–æ –•–û–†–û–®–û –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏!

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ middleware logs –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.
